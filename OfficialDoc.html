<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Syncline IT Solutions — Document Studio</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=DM+Sans:wght@300;400;500&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --navy: #0A2540;
  --navy-mid: #0E3460;
  --navy-light: #1a4a7a;
  --cyan: #17A2B8;
  --cyan-light: #4DC8DC;
  --cyan-dim: rgba(23,162,184,0.15);
  --white: #FFFFFF;
  --off: #F0F4F8;
  --muted: #8DA5BC;
  --border: #D4DFE8;
  --text: #0A1E30;
  --text-light: #4A6580;
  --paper: #FDFEFF;
  --shadow-soft: 0 4px 24px rgba(10,37,64,0.10);
  --shadow-strong: 0 12px 48px rgba(10,37,64,0.18);
  --radius: 4px;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'DM Sans', sans-serif;
  background: #0A2540;
  color: var(--white);
  min-height: 100vh;
  overflow-x: hidden;
}

/* ============ APP SHELL ============ */
.app {
  display: grid;
  grid-template-columns: 280px 1fr;
  grid-template-rows: 64px 1fr;
  min-height: 100vh;
}

/* ============ TOPBAR ============ */
.topbar {
  grid-column: 1 / -1;
  background: rgba(10,25,48,0.97);
  border-bottom: 1px solid rgba(23,162,184,0.2);
  display: flex;
  align-items: center;
  padding: 0 28px;
  gap: 20px;
  position: sticky;
  top: 0;
  z-index: 100;
  backdrop-filter: blur(12px);
}

.logo-mark {
  width: 32px;
  height: 32px;
  flex-shrink: 0;
}

.brand {
  display: flex;
  flex-direction: column;
  line-height: 1;
}
.brand-name {
  font-family: 'Syne', sans-serif;
  font-weight: 700;
  font-size: 16px;
  letter-spacing: -0.3px;
  color: #fff;
}
.brand-sub {
  font-size: 10px;
  font-weight: 400;
  color: var(--cyan);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  margin-top: 2px;
}

.topbar-divider { width: 1px; height: 28px; background: rgba(255,255,255,0.12); margin: 0 8px; }

.topbar-title {
  font-family: 'Syne', sans-serif;
  font-size: 13px;
  font-weight: 600;
  color: var(--cyan-light);
  letter-spacing: 0.1em;
  text-transform: uppercase;
}

.topbar-actions { margin-left: auto; display: flex; gap: 10px; align-items: center; }

.btn {
  font-family: 'DM Sans', sans-serif;
  font-size: 13px;
  font-weight: 500;
  padding: 8px 18px;
  border: none;
  cursor: pointer;
  border-radius: var(--radius);
  transition: all 0.15s;
  display: flex;
  align-items: center;
  gap: 7px;
  white-space: nowrap;
}
.btn-ghost {
  background: transparent;
  border: 1px solid rgba(255,255,255,0.18);
  color: rgba(255,255,255,0.8);
}
.btn-ghost:hover { background: rgba(255,255,255,0.08); color: #fff; }
.btn-primary {
  background: var(--cyan);
  color: #fff;
  border: 1px solid transparent;
}
.btn-primary:hover { background: var(--cyan-light); }
.btn-sm { padding: 6px 12px; font-size: 12px; }

/* ============ SIDEBAR ============ */
.sidebar {
  background: rgba(8,20,40,0.98);
  border-right: 1px solid rgba(23,162,184,0.15);
  padding: 20px 0;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
}

.sidebar-section {
  padding: 0 16px;
  margin-bottom: 8px;
}

.sidebar-label {
  font-size: 9.5px;
  font-weight: 600;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: var(--muted);
  padding: 12px 8px 8px;
  display: block;
}

.doc-type-btn {
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
  padding: 11px 12px;
  border: none;
  background: transparent;
  color: rgba(255,255,255,0.65);
  font-family: 'DM Sans', sans-serif;
  font-size: 13.5px;
  font-weight: 400;
  cursor: pointer;
  border-radius: 6px;
  transition: all 0.15s;
  text-align: left;
  position: relative;
}
.doc-type-btn .icon {
  width: 32px;
  height: 32px;
  border-radius: 6px;
  background: rgba(23,162,184,0.12);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: all 0.15s;
}
.doc-type-btn .icon svg { width: 16px; height: 16px; }
.doc-type-btn:hover { background: rgba(23,162,184,0.08); color: #fff; }
.doc-type-btn.active {
  background: rgba(23,162,184,0.15);
  color: #fff;
}
.doc-type-btn.active .icon { background: var(--cyan); }
.doc-type-btn.active::before {
  content: '';
  position: absolute;
  left: 0;
  top: 6px;
  bottom: 6px;
  width: 3px;
  background: var(--cyan);
  border-radius: 0 3px 3px 0;
}

.sidebar-sep { height: 1px; background: rgba(255,255,255,0.07); margin: 8px 16px; }

.field-panel { padding: 16px 16px 0; flex: 1; }

.field-group { margin-bottom: 16px; }
.field-label {
  display: block;
  font-size: 10.5px;
  font-weight: 600;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: var(--muted);
  margin-bottom: 6px;
}
.field-input {
  width: 100%;
  padding: 9px 11px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: var(--radius);
  color: #fff;
  font-family: 'DM Sans', sans-serif;
  font-size: 13px;
  transition: border-color 0.15s, background 0.15s;
}
.field-input:focus { outline: none; border-color: var(--cyan); background: rgba(23,162,184,0.07); }
.field-input::placeholder { color: rgba(255,255,255,0.25); }
.field-input option { background: #0A2540; color: #fff; }

textarea.field-input {
  resize: vertical;
  min-height: 72px;
  line-height: 1.5;
}

.field-row { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }

/* ============ MAIN PREVIEW ============ */
.preview-area {
  background: #1a2d42;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.preview-toolbar {
  background: rgba(10,25,48,0.9);
  border-bottom: 1px solid rgba(23,162,184,0.12);
  padding: 0 24px;
  height: 48px;
  display: flex;
  align-items: center;
  gap: 14px;
  flex-shrink: 0;
}

.zoom-controls { display: flex; align-items: center; gap: 6px; margin-left: auto; }
.zoom-btn {
  width: 28px;
  height: 28px;
  border-radius: 4px;
  background: rgba(255,255,255,0.08);
  border: none;
  color: rgba(255,255,255,0.7);
  font-size: 16px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.15s;
}
.zoom-btn:hover { background: rgba(255,255,255,0.15); color: #fff; }
.zoom-level {
  font-family: 'DM Mono', monospace;
  font-size: 12px;
  color: var(--muted);
  min-width: 42px;
  text-align: center;
}

.preview-stage {
  flex: 1;
  overflow: auto;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding: 36px 24px;
  background:
    radial-gradient(ellipse at 20% 80%, rgba(23,162,184,0.04) 0%, transparent 60%),
    radial-gradient(ellipse at 80% 20%, rgba(10,37,64,0.3) 0%, transparent 60%),
    #1a2d42;
}

.document-frame {
  transform-origin: top center;
  transition: transform 0.2s ease;
}

/* ============ A4 DOCUMENT ============ */
.a4-doc {
  width: 210mm;
  min-height: 297mm;
  background: var(--paper);
  color: var(--text);
  position: relative;
  box-shadow: var(--shadow-strong), 0 0 0 1px rgba(0,0,0,0.08);
  overflow: hidden;
}

/* ============ LETTERHEAD STYLES ============ */
.lh-header {
  background: var(--navy);
  padding: 28px 36px 24px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: relative;
  overflow: hidden;
}
.lh-header::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--cyan) 0%, transparent 80%);
}
.lh-header-left { display: flex; align-items: center; gap: 14px; }
.lh-logo { width: 44px; height: 44px; }
.lh-brand-name {
  font-family: 'Syne', sans-serif;
  font-size: 22px;
  font-weight: 700;
  color: #fff;
  letter-spacing: -0.5px;
}
.lh-brand-sub {
  font-size: 10px;
  color: var(--cyan-light);
  letter-spacing: 0.1em;
  text-transform: uppercase;
  margin-top: 2px;
}
.lh-contact-info {
  text-align: right;
  font-size: 11px;
  color: rgba(255,255,255,0.65);
  line-height: 1.7;
}
.lh-contact-info a { color: var(--cyan-light); text-decoration: none; }

.lh-body { padding: 32px 36px; }

.lh-date { font-size: 12px; color: var(--text-light); margin-bottom: 24px; font-family: 'DM Mono', monospace; }

.lh-recipient { margin-bottom: 24px; }
.lh-recipient-name { font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 600; color: var(--text); }
.lh-recipient-company { font-size: 13px; color: var(--text-light); margin-top: 2px; }
.lh-recipient-addr { font-size: 12px; color: var(--text-light); margin-top: 2px; line-height: 1.5; }

.lh-divider {
  height: 1px;
  background: linear-gradient(90deg, var(--border) 0%, transparent 100%);
  margin: 20px 0;
}

.lh-subject-block { margin-bottom: 24px; }
.lh-subject-label { font-size: 9.5px; letter-spacing: 0.14em; text-transform: uppercase; color: var(--cyan); font-weight: 600; margin-bottom: 4px; }
.lh-subject-text { font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 600; color: var(--text); }

.lh-salutation { font-size: 14px; margin-bottom: 16px; color: var(--text); }

.lh-paragraph { font-size: 13.5px; line-height: 1.75; color: var(--text); margin-bottom: 14px; }

.lh-bullet-list { margin: 8px 0 16px; padding-left: 0; list-style: none; }
.lh-bullet-list li {
  font-size: 13.5px;
  line-height: 1.7;
  color: var(--text);
  padding: 5px 0 5px 22px;
  position: relative;
  border-bottom: 1px solid var(--border);
}
.lh-bullet-list li:last-child { border-bottom: none; }
.lh-bullet-list li::before {
  content: '';
  position: absolute;
  left: 0;
  top: 13px;
  width: 8px;
  height: 2px;
  background: var(--cyan);
}

.lh-closing { margin-top: 28px; font-size: 13.5px; line-height: 1.7; color: var(--text); }
.lh-signatory { margin-top: 36px; }
.lh-sig-name { font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 600; color: var(--text); }
.lh-sig-title { font-size: 12px; color: var(--text-light); margin-top: 2px; }
.lh-sig-line { width: 120px; height: 1px; background: var(--border); margin: 12px 0 8px; }

.lh-footer {
  position: absolute;
  bottom: 0; left: 0; right: 0;
  padding: 12px 36px;
  background: var(--navy);
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.lh-footer-text { font-size: 10px; color: rgba(255,255,255,0.45); letter-spacing: 0.03em; }
.lh-footer-abn { font-family: 'DM Mono', monospace; font-size: 10px; color: rgba(255,255,255,0.35); }

/* ============ INVOICE STYLES ============ */
.inv-header {
  background: var(--navy);
  padding: 28px 36px 22px;
  position: relative;
  overflow: hidden;
}
.inv-header::before {
  content: 'INVOICE';
  position: absolute;
  right: -10px;
  top: -14px;
  font-family: 'Syne', sans-serif;
  font-size: 90px;
  font-weight: 800;
  color: rgba(255,255,255,0.04);
  letter-spacing: -4px;
  pointer-events: none;
  user-select: none;
}
.inv-header::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--cyan) 0%, transparent 80%);
}
.inv-header-row { display: flex; justify-content: space-between; align-items: flex-start; }
.inv-header-left { display: flex; align-items: center; gap: 14px; }
.inv-logo { width: 40px; height: 40px; }
.inv-brand-name { font-family: 'Syne', sans-serif; font-size: 20px; font-weight: 700; color: #fff; }
.inv-brand-sub { font-size: 10px; color: var(--cyan-light); letter-spacing: 0.1em; text-transform: uppercase; margin-top: 2px; }
.inv-contact { text-align: right; font-size: 11px; color: rgba(255,255,255,0.55); line-height: 1.7; }

.inv-meta-row {
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  padding: 28px 36px 0;
  margin-bottom: 24px;
}
.inv-number-block {}
.inv-word {
  font-family: 'Syne', sans-serif;
  font-size: 36px;
  font-weight: 800;
  color: var(--navy);
  letter-spacing: -1px;
  line-height: 1;
}
.inv-num {
  font-family: 'DM Mono', monospace;
  font-size: 13px;
  color: var(--cyan);
  margin-top: 6px;
  letter-spacing: 0.05em;
}
.inv-dates {
  text-align: right;
  font-size: 12px;
  color: var(--text-light);
  line-height: 1.8;
}
.inv-due-badge {
  display: inline-block;
  background: rgba(23,162,184,0.1);
  border: 1px solid rgba(23,162,184,0.3);
  color: var(--cyan);
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  padding: 3px 8px;
  border-radius: 3px;
  margin-bottom: 4px;
}

.inv-billing { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; padding: 0 36px 24px; }
.inv-billing-block {}
.inv-billing-label {
  font-size: 9.5px;
  font-weight: 600;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: var(--cyan);
  margin-bottom: 8px;
}
.inv-billing-name { font-family: 'Syne', sans-serif; font-size: 14px; font-weight: 600; color: var(--text); }
.inv-billing-detail { font-size: 12px; color: var(--text-light); line-height: 1.7; margin-top: 2px; }
.inv-billing-abn { font-family: 'DM Mono', monospace; font-size: 11px; color: var(--muted); }

.inv-table-wrap { padding: 0 36px 24px; }

.inv-table { width: 100%; border-collapse: collapse; }
.inv-table thead tr { background: var(--navy); }
.inv-table th {
  padding: 10px 14px;
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: rgba(255,255,255,0.7);
  text-align: left;
}
.inv-table th:not(:first-child) { text-align: right; }
.inv-table td {
  padding: 11px 14px;
  font-size: 12.5px;
  color: var(--text);
  border-bottom: 1px solid var(--border);
  vertical-align: top;
}
.inv-table td:not(:first-child) { text-align: right; font-family: 'DM Mono', monospace; font-size: 12px; }
.inv-table tr:hover td { background: rgba(23,162,184,0.03); }
.inv-table .desc-main { font-size: 13px; font-weight: 500; }
.inv-table .desc-sub { font-size: 11px; color: var(--text-light); margin-top: 2px; }

.inv-totals { border-top: none; }
.inv-totals td { border-bottom: none; font-size: 12px; color: var(--text-light); padding: 6px 14px; }
.inv-totals td:first-child { font-size: 11px; letter-spacing: 0.05em; }
.inv-totals-subtotal td { color: var(--text); }
.inv-total-row {
  background: var(--navy) !important;
}
.inv-total-row td {
  padding: 12px 14px !important;
  color: #fff !important;
  font-weight: 600 !important;
  font-size: 13px !important;
}
.inv-total-row td:last-child { font-size: 16px !important; font-family: 'DM Mono', monospace; }

.inv-payment { padding: 0 36px; display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 80px; }
.inv-payment-block {}
.inv-pay-label { font-size: 9.5px; font-weight: 600; letter-spacing: 0.14em; text-transform: uppercase; color: var(--cyan); margin-bottom: 10px; }
.inv-pay-row { display: flex; justify-content: space-between; align-items: baseline; padding: 5px 0; border-bottom: 1px solid var(--border); }
.inv-pay-key { font-size: 11px; color: var(--text-light); }
.inv-pay-val { font-family: 'DM Mono', monospace; font-size: 11px; color: var(--text); }
.inv-terms-text { font-size: 12px; color: var(--text-light); line-height: 1.65; }

/* ============ BUSINESS CARD ============ */
.bc-wrapper {
  padding: 60px 36px;
  background: var(--paper);
  min-height: 297mm;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 48px;
}
.bc-label {
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--text-light);
  margin-bottom: 14px;
  text-align: center;
}
.bc-scale-wrap { display: flex; gap: 40px; justify-content: center; }
.bc-card {
  width: 85mm;
  height: 55mm;
  position: relative;
  border-radius: 4px;
  overflow: hidden;
  box-shadow: 0 6px 32px rgba(10,37,64,0.25), 0 1px 4px rgba(10,37,64,0.15);
  flex-shrink: 0;
}
.bc-front {
  background: var(--navy);
  padding: 18px 20px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: 100%;
}
.bc-front::after {
  content: '';
  position: absolute;
  right: -20px;
  top: -20px;
  width: 100px;
  height: 100px;
  border-radius: 50%;
  border: 20px solid rgba(23,162,184,0.12);
}
.bc-front-top { display: flex; align-items: center; gap: 10px; }
.bc-f-logo { width: 30px; height: 30px; }
.bc-f-name { font-family: 'Syne', sans-serif; font-size: 14px; font-weight: 700; color: #fff; }
.bc-f-tag { font-size: 8px; color: var(--cyan-light); letter-spacing: 0.1em; text-transform: uppercase; margin-top: 1px; }
.bc-front-bar { height: 1px; background: linear-gradient(90deg, var(--cyan) 0%, transparent 100%); margin: 0; }
.bc-front-bottom {}
.bc-f-website { font-family: 'DM Mono', monospace; font-size: 9px; color: rgba(255,255,255,0.4); letter-spacing: 0.07em; }

.bc-back {
  background: var(--paper);
  padding: 18px 20px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  height: 100%;
  border: 1px solid var(--border);
}
.bc-back-top { display: flex; align-items: center; gap: 8px; margin-bottom: 14px; }
.bc-back-accent { width: 3px; height: 36px; background: linear-gradient(180deg, var(--cyan) 0%, var(--navy-mid) 100%); border-radius: 2px; flex-shrink: 0; }
.bc-b-name { font-family: 'Syne', sans-serif; font-size: 13.5px; font-weight: 700; color: var(--text); }
.bc-b-title { font-size: 10px; color: var(--text-light); margin-top: 2px; letter-spacing: 0.03em; }
.bc-b-contact { font-size: 9.5px; color: var(--text-light); line-height: 1.9; }
.bc-b-contact span { font-family: 'DM Mono', monospace; font-size: 9px; color: var(--text); }
.bc-qr {
  position: absolute;
  bottom: 14px;
  right: 16px;
  width: 28px;
  height: 28px;
  border: 1px solid var(--border);
  border-radius: 3px;
  background: var(--off);
  display: flex;
  align-items: center;
  justify-content: center;
}
.bc-qr svg { width: 16px; height: 16px; opacity: 0.25; }

/* ============ ANIMATIONS ============ */
@keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
.a4-doc { animation: fadeIn 0.3s ease; }

/* ============ STATUS BAR ============ */
.status-bar {
  padding: 4px 24px;
  background: rgba(10,25,48,0.8);
  border-top: 1px solid rgba(23,162,184,0.1);
  display: flex;
  gap: 20px;
  align-items: center;
  flex-shrink: 0;
}
.status-item { font-family: 'DM Mono', monospace; font-size: 10px; color: var(--muted); display: flex; align-items: center; gap: 5px; }
.status-dot { width: 6px; height: 6px; border-radius: 50%; background: #22c55e; }

/* ============ PRINT STYLES ============ */
@media print {
  body { background: white; }
  .app { display: block; }
  .topbar, .sidebar, .preview-toolbar, .status-bar, .zoom-controls { display: none !important; }
  .preview-area { background: white; }
  .preview-stage { padding: 0; background: white; }
  .document-frame { transform: none !important; }
  .a4-doc { box-shadow: none; }
}
</style>
</head>
<body>
<div class="app">

  <!-- TOPBAR -->
  <div class="topbar">
    <svg class="logo-mark" viewBox="0 0 3000 3000" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="tg" x1="176.99954" y1="1399.7181" x2="1408.4789" y2="194.47311" gradientUnits="userSpaceOnUse" gradientTransform="matrix(1.5333872,0,0,1.5333872,916.56257,412.37694)">
          <stop offset="0" stop-color="#0a1a2f"/>
          <stop offset="1" stop-color="#0077ff"/>
        </linearGradient>
      </defs>
      <g transform="translate(-643.27242,-139.08675)">
        <path fill="#0A3D62" d="m 2127.1452,293.38339 a 1068.2847,1345.8561 0 0 0 -49.6876,2.40364 1068.2847,1345.8561 0 0 0 -1000.4524,1426.00267 1068.2847,1345.8561 0 0 0 189.8174,686.7923 85.827995,1802.388 45.498038 0 1 166.2429,-174.8746 791.64989,1345.9819 0 0 1 -79.9449,-511.9109 791.64989,1345.9819 0 0 1 741.3811,-1426.13453 791.64989,1345.9819 0 0 1 32.6435,-2.27858 z m 32.2545,0 A 791.64989,1345.9819 0 0 1 2801.6452,891.65475 85.827995,1802.388 45.498038 0 1 2949.708,756.39851 1068.2847,1345.8561 0 0 0 2159.3997,293.38339 Z m 860.3227,576.20801 a 85.827995,1802.388 45.498038 0 1 -166.2393,174.8744 791.64989,1345.9819 0 0 1 79.9276,511.4873 791.64989,1345.9819 0 0 1 -741.121,1426.534 l -0.4931,0.052 a 791.64989,1345.9819 0 0 1 -32.3969,2.2509 1068.2847,1345.8561 0 0 0 49.3509,-2.3793 l 0.6703,-0.052 A 1068.2847,1345.8561 0 0 0 3209.5192,1555.9636 1068.2847,1345.8561 0 0 0 3019.7224,869.5914 Z M 1484.8999,2386.5186 a 85.827995,1802.388 45.498038 0 1 -148.0629,135.2563 1068.2847,1345.8561 0 0 0 790.3082,463.0152 791.64989,1345.9819 0 0 1 -642.2453,-598.2715 z"/>
        <path fill="url(#tg)" d="M 1189.3536,2580.9559 A 34.639689,1343.0753 45.45491 0 1 2060.1985,1672.3402 34.639689,1343.0753 45.45491 0 1 3097.1652,697.22793 34.639689,1343.0753 45.45491 0 1 2226.645,1605.5383 34.639689,1343.0753 45.45491 0 1 1189.4058,2580.9349"/>
      </g>
    </svg>
    <div class="brand">
      <span class="brand-name">Syncline IT Solutions</span>
      <span class="brand-sub">Document Studio</span>
    </div>
    <div class="topbar-divider"></div>
    <span class="topbar-title" id="doc-type-title">Letterhead</span>
    <div class="topbar-actions">
      <button class="btn btn-ghost btn-sm" onclick="window.print()">
        <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>
        Print / Export PDF
      </button>
    </div>
  </div>

  <!-- SIDEBAR -->
  <div class="sidebar">
    <div class="sidebar-section">
      <span class="sidebar-label">Document Type</span>
      <button class="doc-type-btn active" onclick="switchDoc('letterhead')" id="btn-letterhead">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
        </span>
        Letterhead
      </button>
      <button class="doc-type-btn" onclick="switchDoc('invoice')" id="btn-invoice">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/></svg>
        </span>
        Tax Invoice
      </button>
      <button class="doc-type-btn" onclick="switchDoc('businesscard')" id="btn-businesscard">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 3v4"/><path d="M8 3v4"/><line x1="7" y1="14" x2="17" y2="14"/><line x1="7" y1="18" x2="12" y2="18"/></svg>
        </span>
        Business Card
      </button>
    </div>

    <div class="sidebar-sep"></div>

    <!-- DYNAMIC FIELDS -->
    <div class="field-panel" id="fields-letterhead">
      <span class="sidebar-label" style="padding-top:4px">Sender Details</span>
      <div class="field-group">
        <label class="field-label">Date</label>
        <input class="field-input" type="text" id="lh-date" value="18 February 2026" oninput="updateLetterhead()">
      </div>
      <div class="sidebar-sep" style="margin: 8px 0;"></div>
      <span class="sidebar-label" style="padding-top:4px">Recipient</span>
      <div class="field-group">
        <label class="field-label">Name</label>
        <input class="field-input" type="text" id="lh-rec-name" value="Mr. Johnathan Reynolds" oninput="updateLetterhead()">
      </div>
      <div class="field-group">
        <label class="field-label">Company</label>
        <input class="field-input" type="text" id="lh-rec-company" value="TechNova Enterprises Pty Ltd" oninput="updateLetterhead()">
      </div>
      <div class="field-group">
        <label class="field-label">Address</label>
        <input class="field-input" type="text" id="lh-rec-addr1" value="Level 12, 456 Collins Street" oninput="updateLetterhead()">
        <input class="field-input" type="text" id="lh-rec-addr2" value="Melbourne, VIC 3000" oninput="updateLetterhead()" style="margin-top:4px">
      </div>
      <div class="sidebar-sep" style="margin: 8px 0;"></div>
      <span class="sidebar-label" style="padding-top:4px">Letter Content</span>
      <div class="field-group">
        <label class="field-label">Subject</label>
        <input class="field-input" type="text" id="lh-subject" value="Managed IT Services Agreement – Renewal &amp; Infrastructure Enhancement" oninput="updateLetterhead()">
      </div>
      <div class="field-group">
        <label class="field-label">Body (paragraph 1)</label>
        <textarea class="field-input" id="lh-body1" oninput="updateLetterhead()">Thank you for your continued partnership with Syncline IT Solutions. This letter serves to confirm the renewal of our managed services agreement and outlines the proposed enhancements to your infrastructure to support your upcoming expansion.</textarea>
      </div>
      <div class="field-group">
        <label class="field-label">Body (paragraph 2)</label>
        <textarea class="field-input" id="lh-body2" oninput="updateLetterhead()">We anticipate full implementation within 8 weeks, with zero planned downtime during business hours. Detailed project timeline and cost summary are attached for your review. Please let us know a convenient time to discuss next steps.</textarea>
      </div>
      <div class="sidebar-sep" style="margin: 8px 0;"></div>
      <span class="sidebar-label" style="padding-top:4px">Signatory</span>
      <div class="field-group">
        <label class="field-label">Name</label>
        <input class="field-input" type="text" id="lh-sig-name" value="Shakil Ahmed" oninput="updateLetterhead()">
      </div>
      <div class="field-group">
        <label class="field-label">Title</label>
        <input class="field-input" type="text" id="lh-sig-title" value="Principal Consultant" oninput="updateLetterhead()">
      </div>
    </div>

    <div class="field-panel" id="fields-invoice" style="display:none">
      <span class="sidebar-label" style="padding-top:4px">Invoice Details</span>
      <div class="field-group">
        <label class="field-label">Invoice No.</label>
        <input class="field-input" type="text" id="inv-num" value="INV-2026-047" oninput="updateInvoice()">
      </div>
      <div class="field-row">
        <div>
          <label class="field-label">Issue Date</label>
          <input class="field-input" type="text" id="inv-issue" value="18 Feb 2026" oninput="updateInvoice()">
        </div>
        <div>
          <label class="field-label">Due Date</label>
          <input class="field-input" type="text" id="inv-due" value="18 Mar 2026" oninput="updateInvoice()">
        </div>
      </div>
      <div class="sidebar-sep" style="margin: 8px 0;"></div>
      <span class="sidebar-label" style="padding-top:4px">Bill To</span>
      <div class="field-group">
        <label class="field-label">Client Name</label>
        <input class="field-input" type="text" id="inv-client" value="TechNova Enterprises Pty Ltd" oninput="updateInvoice()">
      </div>
      <div class="field-group">
        <label class="field-label">Client Address</label>
        <input class="field-input" type="text" id="inv-caddr1" value="Level 12, 456 Collins Street" oninput="updateInvoice()">
        <input class="field-input" type="text" id="inv-caddr2" value="Melbourne VIC 3000" oninput="updateInvoice()" style="margin-top:4px">
      </div>
      <div class="field-group">
        <label class="field-label">Client ABN</label>
        <input class="field-input" type="text" id="inv-cabn" value="98 765 432 109" oninput="updateInvoice()">
      </div>
      <div class="sidebar-sep" style="margin: 8px 0;"></div>
      <span class="sidebar-label" style="padding-top:4px">Line Items</span>
      <div id="line-items-list"></div>
      <button class="btn btn-ghost btn-sm" onclick="addLineItem()" style="width:100%;justify-content:center;margin-top:4px;margin-bottom:12px">
        + Add Line Item
      </button>
      <div class="sidebar-sep" style="margin: 8px 0;"></div>
      <span class="sidebar-label" style="padding-top:4px">GST Rate</span>
      <div class="field-group">
        <label class="field-label">GST %</label>
        <input class="field-input" type="number" id="inv-gst" value="10" oninput="updateInvoice()" min="0" max="100">
      </div>
      <span class="sidebar-label" style="padding-top:4px">Payment Details</span>
      <div class="field-group">
        <label class="field-label">Bank</label>
        <input class="field-input" type="text" id="inv-bank" value="ANZ Banking Group" oninput="updateInvoice()">
      </div>
      <div class="field-row">
        <div>
          <label class="field-label">BSB</label>
          <input class="field-input" type="text" id="inv-bsb" value="013-006" oninput="updateInvoice()">
        </div>
        <div>
          <label class="field-label">Account No.</label>
          <input class="field-input" type="text" id="inv-acct" value="4567 8901" oninput="updateInvoice()">
        </div>
      </div>
      <div class="field-group">
        <label class="field-label">Account Name</label>
        <input class="field-input" type="text" id="inv-aname" value="Syncline IT Solutions" oninput="updateInvoice()">
      </div>
    </div>

    <div class="field-panel" id="fields-businesscard" style="display:none">
      <span class="sidebar-label" style="padding-top:4px">Card Holder</span>
      <div class="field-group">
        <label class="field-label">Full Name</label>
        <input class="field-input" type="text" id="bc-name" value="Shakil Ahmed" oninput="updateCard()">
      </div>
      <div class="field-group">
        <label class="field-label">Job Title</label>
        <input class="field-input" type="text" id="bc-title" value="Principal Consultant" oninput="updateCard()">
      </div>
      <div class="field-group">
        <label class="field-label">Phone</label>
        <input class="field-input" type="text" id="bc-phone" value="+61 412 345 678" oninput="updateCard()">
      </div>
      <div class="field-group">
        <label class="field-label">Email</label>
        <input class="field-input" type="text" id="bc-email" value="shakil@synclineit.com" oninput="updateCard()">
      </div>
      <div class="field-group">
        <label class="field-label">Website</label>
        <input class="field-input" type="text" id="bc-website" value="www.synclineit.com" oninput="updateCard()">
      </div>
    </div>
  </div>

  <!-- MAIN PREVIEW -->
  <div class="preview-area">
    <div class="preview-toolbar">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="rgba(255,255,255,0.5)" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="9" y1="9" x2="15" y2="15"/><line x1="15" y1="9" x2="9" y2="15"/></svg>
      <span style="font-size:12px;color:var(--muted)">Live Preview — A4 (210 × 297 mm)</span>
      <div class="zoom-controls">
        <button class="zoom-btn" onclick="adjustZoom(-0.1)">−</button>
        <span class="zoom-level" id="zoom-label">70%</span>
        <button class="zoom-btn" onclick="adjustZoom(0.1)">+</button>
        <button class="zoom-btn btn-ghost btn-sm" onclick="fitZoom()" title="Fit to window" style="width:auto;padding:0 8px;font-size:10px;letter-spacing:0.05em;font-family:'DM Mono',monospace;color:var(--muted)">FIT</button>
      </div>
    </div>
    <div class="preview-stage" id="stage">
      <div class="document-frame" id="doc-frame">
        <!-- Document rendered here -->
      </div>
    </div>
    <div class="status-bar">
      <span class="status-item"><span class="status-dot"></span> Ready</span>
      <span class="status-item">A4 · 210 × 297 mm</span>
      <span class="status-item" id="status-doc">Letterhead</span>
      <span class="status-item" id="inv-total-status" style="display:none;color:var(--cyan)"></span>
    </div>
  </div>

</div>

<!-- SVG LOGO TEMPLATE (hidden, reused via innerHTML clone) -->
<svg id="logo-svg-template" style="display:none" viewBox="0 0 3000 3000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="lg-main" x1="176.99954" y1="1399.7181" x2="1408.4789" y2="194.47311" gradientUnits="userSpaceOnUse" gradientTransform="matrix(1.5333872,0,0,1.5333872,916.56257,412.37694)">
      <stop offset="0" stop-color="#0a1a2f"/>
      <stop offset="1" stop-color="#0077ff"/>
    </linearGradient>
  </defs>
  <g transform="translate(-643.27242,-139.08675)">
    <path fill="#0A3D62" d="m 2127.1452,293.38339 a 1068.2847,1345.8561 0 0 0 -49.6876,2.40364 1068.2847,1345.8561 0 0 0 -1000.4524,1426.00267 1068.2847,1345.8561 0 0 0 189.8174,686.7923 85.827995,1802.388 45.498038 0 1 166.2429,-174.8746 791.64989,1345.9819 0 0 1 -79.9449,-511.9109 791.64989,1345.9819 0 0 1 741.3811,-1426.13453 791.64989,1345.9819 0 0 1 32.6435,-2.27858 z m 32.2545,0 A 791.64989,1345.9819 0 0 1 2801.6452,891.65475 85.827995,1802.388 45.498038 0 1 2949.708,756.39851 1068.2847,1345.8561 0 0 0 2159.3997,293.38339 Z m 860.3227,576.20801 a 85.827995,1802.388 45.498038 0 1 -166.2393,174.8744 791.64989,1345.9819 0 0 1 79.9276,511.4873 791.64989,1345.9819 0 0 1 -741.121,1426.534 l -0.4931,0.052 a 791.64989,1345.9819 0 0 1 -32.3969,2.2509 1068.2847,1345.8561 0 0 0 49.3509,-2.3793 l 0.6703,-0.052 A 1068.2847,1345.8561 0 0 0 3209.5192,1555.9636 1068.2847,1345.8561 0 0 0 3019.7224,869.5914 Z M 1484.8999,2386.5186 a 85.827995,1802.388 45.498038 0 1 -148.0629,135.2563 1068.2847,1345.8561 0 0 0 790.3082,463.0152 791.64989,1345.9819 0 0 1 -642.2453,-598.2715 z"/>
    <path fill="url(#lg-main)" d="M 1189.3536,2580.9559 A 34.639689,1343.0753 45.45491 0 1 2060.1985,1672.3402 34.639689,1343.0753 45.45491 0 1 3097.1652,697.22793 34.639689,1343.0753 45.45491 0 1 2226.645,1605.5383 34.639689,1343.0753 45.45491 0 1 1189.4058,2580.9349"/>
  </g>
</svg>

<script>
// ============ STATE ============
let currentDoc = 'letterhead';
let zoom = 0.7;

let lineItems = [
  { desc: 'Advanced Network Monitoring & SIEM Deployment', sub: 'Project deployment', qty: 1, unit: 8500 },
  { desc: 'Automation Workflow Configuration', sub: '40 hours @ $185/hr', qty: 40, unit: 185 },
  { desc: 'Azure Hybrid Cloud Integration & Migration', sub: 'Full cloud migration project', qty: 1, unit: 6200 },
  { desc: 'Enterprise Documentation Platform Setup', sub: 'Initial configuration & onboarding', qty: 1, unit: 4800 },
  { desc: 'Monthly Managed Services – February 2026', sub: 'Ongoing support & monitoring', qty: 1, unit: 3250 },
];

function getLogo(size=40, idSuffix='') {
  return `<svg width="${size}" height="${size}" viewBox="0 0 3000 3000" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="lg${idSuffix}" x1="176.99954" y1="1399.7181" x2="1408.4789" y2="194.47311" gradientUnits="userSpaceOnUse" gradientTransform="matrix(1.5333872,0,0,1.5333872,916.56257,412.37694)">
        <stop offset="0" stop-color="#0a1a2f"/>
        <stop offset="1" stop-color="#0077ff"/>
      </linearGradient>
    </defs>
    <g transform="translate(-643.27242,-139.08675)">
      <path fill="#0A3D62" d="m 2127.1452,293.38339 a 1068.2847,1345.8561 0 0 0 -49.6876,2.40364 1068.2847,1345.8561 0 0 0 -1000.4524,1426.00267 1068.2847,1345.8561 0 0 0 189.8174,686.7923 85.827995,1802.388 45.498038 0 1 166.2429,-174.8746 791.64989,1345.9819 0 0 1 -79.9449,-511.9109 791.64989,1345.9819 0 0 1 741.3811,-1426.13453 791.64989,1345.9819 0 0 1 32.6435,-2.27858 z m 32.2545,0 A 791.64989,1345.9819 0 0 1 2801.6452,891.65475 85.827995,1802.388 45.498038 0 1 2949.708,756.39851 1068.2847,1345.8561 0 0 0 2159.3997,293.38339 Z m 860.3227,576.20801 a 85.827995,1802.388 45.498038 0 1 -166.2393,174.8744 791.64989,1345.9819 0 0 1 79.9276,511.4873 791.64989,1345.9819 0 0 1 -741.121,1426.534 l -0.4931,0.052 a 791.64989,1345.9819 0 0 1 -32.3969,2.2509 1068.2847,1345.8561 0 0 0 49.3509,-2.3793 l 0.6703,-0.052 A 1068.2847,1345.8561 0 0 0 3209.5192,1555.9636 1068.2847,1345.8561 0 0 0 3019.7224,869.5914 Z M 1484.8999,2386.5186 a 85.827995,1802.388 45.498038 0 1 -148.0629,135.2563 1068.2847,1345.8561 0 0 0 790.3082,463.0152 791.64989,1345.9819 0 0 1 -642.2453,-598.2715 z"/>
      <path fill="url(#lg${idSuffix})" d="M 1189.3536,2580.9559 A 34.639689,1343.0753 45.45491 0 1 2060.1985,1672.3402 34.639689,1343.0753 45.45491 0 1 3097.1652,697.22793 34.639689,1343.0753 45.45491 0 1 2226.645,1605.5383 34.639689,1343.0753 45.45491 0 1 1189.4058,2580.9349"/>
    </g>
  </svg>`;
}

function getLogoWhite(size=40) {
  return `<svg width="${size}" height="${size}" viewBox="0 0 3000 3000" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <linearGradient id="lgw" x1="176.99954" y1="1399.7181" x2="1408.4789" y2="194.47311" gradientUnits="userSpaceOnUse" gradientTransform="matrix(1.5333872,0,0,1.5333872,916.56257,412.37694)">
        <stop offset="0" stop-color="#ffffff"/>
        <stop offset="1" stop-color="#a0d0ff"/>
      </linearGradient>
    </defs>
    <g transform="translate(-643.27242,-139.08675)">
      <path fill="white" d="m 2127.1452,293.38339 a 1068.2847,1345.8561 0 0 0 -49.6876,2.40364 1068.2847,1345.8561 0 0 0 -1000.4524,1426.00267 1068.2847,1345.8561 0 0 0 189.8174,686.7923 85.827995,1802.388 45.498038 0 1 166.2429,-174.8746 791.64989,1345.9819 0 0 1 -79.9449,-511.9109 791.64989,1345.9819 0 0 1 741.3811,-1426.13453 791.64989,1345.9819 0 0 1 32.6435,-2.27858 z m 32.2545,0 A 791.64989,1345.9819 0 0 1 2801.6452,891.65475 85.827995,1802.388 45.498038 0 1 2949.708,756.39851 1068.2847,1345.8561 0 0 0 2159.3997,293.38339 Z m 860.3227,576.20801 a 85.827995,1802.388 45.498038 0 1 -166.2393,174.8744 791.64989,1345.9819 0 0 1 79.9276,511.4873 791.64989,1345.9819 0 0 1 -741.121,1426.534 l -0.4931,0.052 a 791.64989,1345.9819 0 0 1 -32.3969,2.2509 1068.2847,1345.8561 0 0 0 49.3509,-2.3793 l 0.6703,-0.052 A 1068.2847,1345.8561 0 0 0 3209.5192,1555.9636 1068.2847,1345.8561 0 0 0 3019.7224,869.5914 Z M 1484.8999,2386.5186 a 85.827995,1802.388 45.498038 0 1 -148.0629,135.2563 1068.2847,1345.8561 0 0 0 790.3082,463.0152 791.64989,1345.9819 0 0 1 -642.2453,-598.2715 z"/>
      <path fill="url(#lgw)" d="M 1189.3536,2580.9559 A 34.639689,1343.0753 45.45491 0 1 2060.1985,1672.3402 34.639689,1343.0753 45.45491 0 1 3097.1652,697.22793 34.639689,1343.0753 45.45491 0 1 2226.645,1605.5383 34.639689,1343.0753 45.45491 0 1 1189.4058,2580.9349"/>
    </g>
  </svg>`;
}

function fmt(n) { return '$' + n.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ','); }
function v(id) { const el=document.getElementById(id); return el ? el.value : ''; }

// ============ SWITCH DOC ============
function switchDoc(type) {
  currentDoc = type;
  ['letterhead','invoice','businesscard'].forEach(t => {
    document.getElementById('btn-'+t).classList.toggle('active', t===type);
    document.getElementById('fields-'+t).style.display = t===type ? 'block' : 'none';
  });
  document.getElementById('doc-type-title').textContent = {letterhead:'Letterhead',invoice:'Tax Invoice',businesscard:'Business Cards'}[type];
  document.getElementById('status-doc').textContent = {letterhead:'Letterhead',invoice:'Tax Invoice',businesscard:'Business Card'}[type];
  document.getElementById('inv-total-status').style.display = type==='invoice' ? 'inline-flex' : 'none';
  render();
}

// ============ ZOOM ============
function applyZoom() {
  document.getElementById('doc-frame').style.transform = `scale(${zoom})`;
  document.getElementById('zoom-label').textContent = Math.round(zoom*100)+'%';
}
function adjustZoom(d) { zoom = Math.min(1.4, Math.max(0.3, zoom+d)); applyZoom(); }
function fitZoom() {
  const stage = document.getElementById('stage');
  const w = stage.clientWidth - 48;
  const docW = 794; // 210mm ≈ 794px
  zoom = Math.min(1, w/docW);
  applyZoom();
}

// ============ LINE ITEMS SIDEBAR ============
function renderLineItemsSidebar() {
  const container = document.getElementById('line-items-list');
  container.innerHTML = lineItems.map((item,i) => `
    <div style="background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:4px;padding:10px;margin-bottom:8px">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
        <span style="font-size:10px;color:var(--muted);font-weight:600;letter-spacing:0.08em;text-transform:uppercase">Item ${i+1}</span>
        <button onclick="removeLineItem(${i})" style="background:none;border:none;color:rgba(255,255,255,0.3);cursor:pointer;font-size:14px;line-height:1;padding:0 2px" title="Remove">×</button>
      </div>
      <input class="field-input" type="text" value="${item.desc}" oninput="lineItems[${i}].desc=this.value;updateInvoice()" style="margin-bottom:4px" placeholder="Description">
      <input class="field-input" type="text" value="${item.sub}" oninput="lineItems[${i}].sub=this.value;updateInvoice()" style="margin-bottom:4px" placeholder="Sub-line (optional)">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:4px">
        <input class="field-input" type="number" value="${item.qty}" oninput="lineItems[${i}].qty=+this.value;updateInvoice()" placeholder="Qty">
        <input class="field-input" type="number" value="${item.unit}" oninput="lineItems[${i}].unit=+this.value;updateInvoice()" placeholder="Unit $">
      </div>
    </div>
  `).join('');
}

function addLineItem() {
  lineItems.push({ desc: 'New Service Item', sub: '', qty: 1, unit: 0 });
  renderLineItemsSidebar();
  updateInvoice();
}
function removeLineItem(i) {
  lineItems.splice(i,1);
  renderLineItemsSidebar();
  updateInvoice();
}

// ============ RENDER ============
function render() {
  if (currentDoc === 'letterhead') renderLetterhead();
  else if (currentDoc === 'invoice') renderInvoice();
  else renderCard();
}

function updateLetterhead() { renderLetterhead(); }
function updateInvoice() { renderLineItemsSidebar(); renderInvoice(); }
function updateCard() { renderCard(); }

function renderLetterhead() {
  const html = `
  <div class="a4-doc" style="padding-bottom:60px">
    <div class="lh-header">
      <div class="lh-header-left">
        ${getLogoWhite(44)}
        <div>
          <div class="lh-brand-name">Syncline IT Solutions</div>
          <div class="lh-brand-sub">Precision systems for modern businesses</div>
        </div>
      </div>
      <div class="lh-contact-info">
        <div>123 Example Street, Melbourne VIC 3000</div>
        <div>+61 3 1234 5678 · <a href="#">info@synclineit.com</a></div>
        <div><a href="#">www.synclineit.com</a></div>
      </div>
    </div>
    <div class="lh-body">
      <div class="lh-date">${v('lh-date')}</div>
      <div class="lh-recipient">
        <div class="lh-recipient-name">${v('lh-rec-name')}</div>
        <div class="lh-recipient-company">${v('lh-rec-company')}</div>
        <div class="lh-recipient-addr">${v('lh-rec-addr1')}<br>${v('lh-rec-addr2')}</div>
      </div>
      <div class="lh-divider"></div>
      <div class="lh-subject-block">
        <div class="lh-subject-label">Re:</div>
        <div class="lh-subject-text">${v('lh-subject')}</div>
      </div>
      <div class="lh-divider"></div>
      <div class="lh-salutation">Dear ${v('lh-rec-name').replace(/^(Mr\.|Ms\.|Dr\.|Mrs\.)\s+/,'').split(' ').slice(-1)[0]},</div>
      <div class="lh-paragraph">${v('lh-body1')}</div>
      <div class="lh-paragraph">Our recommended scope includes:</div>
      <ul class="lh-bullet-list">
        <li>Upgraded network monitoring and alerting system</li>
        <li>Enhanced automation workflows for routine operations</li>
        <li>Cloud-hybrid integration with improved documentation controls</li>
        <li>24/7 proactive infrastructure monitoring</li>
      </ul>
      <div class="lh-paragraph">${v('lh-body2')}</div>
      <div class="lh-closing">Kind regards,</div>
      <div class="lh-signatory">
        <div class="lh-sig-line"></div>
        <div class="lh-sig-name">${v('lh-sig-name')}</div>
        <div class="lh-sig-title">${v('lh-sig-title')}</div>
        <div class="lh-sig-title" style="margin-top:2px;font-size:11px">Syncline IT Solutions</div>
      </div>
    </div>
    <div class="lh-footer">
      <span class="lh-footer-text">Confidential – For intended recipient only. If received in error, please delete and notify sender immediately.</span>
      <span class="lh-footer-abn">ABN 12 345 678 901</span>
    </div>
  </div>`;
  document.getElementById('doc-frame').innerHTML = html;
}

function renderInvoice() {
  const gstRate = parseFloat(v('inv-gst')) || 0;
  const subtotal = lineItems.reduce((s,i) => s + i.qty*i.unit, 0);
  const gst = subtotal * gstRate / 100;
  const total = subtotal + gst;

  document.getElementById('inv-total-status').textContent = 'Total: ' + fmt(total);

  const rows = lineItems.map(item => `
    <tr>
      <td><div class="desc-main">${item.desc}</div>${item.sub ? `<div class="desc-sub">${item.sub}</div>` : ''}</td>
      <td>${item.qty}</td>
      <td>${fmt(item.unit)}</td>
      <td>${fmt(item.qty * item.unit)}</td>
    </tr>
  `).join('');

  const html = `
  <div class="a4-doc" style="padding-bottom:0">
    <div class="inv-header">
      <div class="inv-header-row">
        <div class="inv-header-left">
          ${getLogoWhite(40)}
          <div>
            <div class="inv-brand-name">Syncline IT Solutions</div>
            <div class="inv-brand-sub">Precision systems for modern businesses</div>
          </div>
        </div>
        <div class="inv-contact">
          <div>123 Example Street, Melbourne VIC 3000</div>
          <div>+61 3 1234 5678 · info@synclineit.com</div>
          <div>ABN 12 345 678 901</div>
        </div>
      </div>
    </div>

    <div class="inv-meta-row">
      <div class="inv-number-block">
        <div class="inv-word">INVOICE</div>
        <div class="inv-num">${v('inv-num')}</div>
      </div>
      <div class="inv-dates">
        <div class="inv-due-badge">Due ${v('inv-due')}</div>
        <div><strong>Issue Date:</strong> ${v('inv-issue')}</div>
        <div><strong>Due Date:</strong> ${v('inv-due')}</div>
      </div>
    </div>

    <div class="inv-billing">
      <div class="inv-billing-block">
        <div class="inv-billing-label">From</div>
        <div class="inv-billing-name">Syncline IT Solutions</div>
        <div class="inv-billing-detail">123 Example Street<br>Melbourne VIC 3000</div>
        <div class="inv-billing-abn" style="margin-top:4px">ABN 12 345 678 901</div>
      </div>
      <div class="inv-billing-block">
        <div class="inv-billing-label">Bill To</div>
        <div class="inv-billing-name">${v('inv-client')}</div>
        <div class="inv-billing-detail">${v('inv-caddr1')}<br>${v('inv-caddr2')}</div>
        <div class="inv-billing-abn" style="margin-top:4px">ABN ${v('inv-cabn')}</div>
      </div>
    </div>

    <div class="inv-table-wrap">
      <table class="inv-table">
        <thead>
          <tr>
            <th>Description</th>
            <th style="text-align:right">Qty</th>
            <th style="text-align:right">Unit Price</th>
            <th style="text-align:right">Amount (AUD)</th>
          </tr>
        </thead>
        <tbody>
          ${rows}
          <tr class="inv-totals inv-totals-subtotal">
            <td colspan="3" style="text-align:right;border-bottom:1px solid var(--border)">Subtotal</td>
            <td style="font-family:'DM Mono',monospace;border-bottom:1px solid var(--border)">${fmt(subtotal)}</td>
          </tr>
          <tr class="inv-totals">
            <td colspan="3" style="text-align:right">GST (${gstRate}%)</td>
            <td style="font-family:'DM Mono',monospace">${fmt(gst)}</td>
          </tr>
          <tr class="inv-total-row">
            <td colspan="3" style="text-align:right">Total AUD</td>
            <td>${fmt(total)}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="inv-payment">
      <div class="inv-payment-block">
        <div class="inv-pay-label">Payment Instructions</div>
        <div class="inv-pay-row"><span class="inv-pay-key">Bank</span><span class="inv-pay-val">${v('inv-bank')}</span></div>
        <div class="inv-pay-row"><span class="inv-pay-key">BSB</span><span class="inv-pay-val">${v('inv-bsb')}</span></div>
        <div class="inv-pay-row"><span class="inv-pay-key">Account No.</span><span class="inv-pay-val">${v('inv-acct')}</span></div>
        <div class="inv-pay-row"><span class="inv-pay-key">Account Name</span><span class="inv-pay-val">${v('inv-aname')}</span></div>
        <div class="inv-pay-row"><span class="inv-pay-key">Reference</span><span class="inv-pay-val">${v('inv-num')}</span></div>
      </div>
      <div class="inv-payment-block">
        <div class="inv-pay-label">Terms & Conditions</div>
        <div class="inv-terms-text">Payment is due within 30 days of invoice date. Late payments may incur interest at 1.5% per month. All amounts are in Australian Dollars (AUD) and include GST where applicable.</div>
        <div style="margin-top:12px;padding:10px;background:rgba(23,162,184,0.07);border:1px solid rgba(23,162,184,0.2);border-radius:3px">
          <div style="font-size:9px;letter-spacing:0.12em;text-transform:uppercase;color:var(--cyan);font-weight:600;margin-bottom:4px">Thank you for your business</div>
          <div style="font-size:11px;color:var(--text-light)">We appreciate your prompt payment and look forward to continuing our partnership.</div>
        </div>
      </div>
    </div>

    <div class="lh-footer">
      <span class="lh-footer-text">Syncline IT Solutions Pty Ltd · ABN 12 345 678 901 · www.synclineit.com</span>
      <span class="lh-footer-abn">${v('inv-num')}</span>
    </div>
  </div>`;
  document.getElementById('doc-frame').innerHTML = html;
}

function renderCard() {
  const name = v('bc-name');
  const title = v('bc-title');
  const phone = v('bc-phone');
  const email = v('bc-email');
  const website = v('bc-website');

  const html = `
  <div class="a4-doc">
    <div class="bc-wrapper">
      <div>
        <div class="bc-label">Front of Card</div>
        <div style="display:flex;justify-content:center">
          <div class="bc-card">
            <div class="bc-front">
              <div class="bc-front-top">
                ${getLogoWhite(30)}
                <div>
                  <div class="bc-f-name">Syncline IT Solutions</div>
                  <div class="bc-f-tag">Precision systems for modern businesses</div>
                </div>
              </div>
              <div class="bc-front-bar"></div>
              <div class="bc-front-bottom">
                <div class="bc-f-website">${website}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div>
        <div class="bc-label">Back of Card</div>
        <div style="display:flex;justify-content:center">
          <div class="bc-card">
            <div class="bc-back">
              <div class="bc-back-top">
                <div class="bc-back-accent"></div>
                <div>
                  <div class="bc-b-name">${name}</div>
                  <div class="bc-b-title">${title}</div>
                </div>
              </div>
              <div class="bc-b-contact">
                <div>Phone <span>${phone}</span></div>
                <div>Email <span>${email}</span></div>
                <div>Web <span>${website}</span></div>
              </div>
              <div class="bc-qr">
                <svg viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="1.5"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="5" y="5" width="3" height="3" fill="black"/><rect x="16" y="5" width="3" height="3" fill="black"/><rect x="5" y="16" width="3" height="3" fill="black"/><line x1="14" y1="14" x2="14" y2="14"/><line x1="17" y1="14" x2="17" y2="14"/><line x1="20" y1="14" x2="20" y2="14"/><line x1="14" y1="17" x2="14" y2="17"/><line x1="17" y1="17" x2="17" y2="17"/><line x1="20" y1="17" x2="20" y2="17"/><line x1="14" y1="20" x2="14" y2="20"/><line x1="17" y1="20" x2="17" y2="20"/><line x1="20" y1="20" x2="20" y2="20"/></svg>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Bleed safe zone note -->
      <div style="text-align:center;margin-top:8px">
        <div style="display:inline-flex;align-items:center;gap:8px;padding:8px 16px;background:rgba(23,162,184,0.08);border:1px solid rgba(23,162,184,0.2);border-radius:4px">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#17A2B8" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
          <span style="font-size:11px;color:#17A2B8;font-family:'DM Mono',monospace">85 × 55 mm · 3mm bleed recommended for print</span>
        </div>
      </div>
    </div>
  </div>`;
  document.getElementById('doc-frame').innerHTML = html;
}

// ============ INIT ============
renderLineItemsSidebar();
fitZoom();
renderLetterhead();
window.addEventListener('resize', fitZoom);
</script>
</body>
</html>